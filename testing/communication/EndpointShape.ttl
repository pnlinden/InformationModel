@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix ids: <https://w3id.org/idsa/core/> .
@prefix idsm: <https://w3id.org/idsa/metamodel/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .


<#EndpointShape>
    a sh:NodeShape ;

    # ToDo: One of the following two lines can be omitted. If
    # shacl does not check for inheritance, the first one can be
    # deleted. Otherwise the second one is unnecessary.
    sh:targetClass ids:Endpoint ;
    sh:targetClass ids:StaticEndpoint , ids:InteractiveEndpoint ;

    sh:property [
        a sh:PropertyShape ;
        sh:path ids:endpointHost ;
        sh:class ids:Host ;
        # idsm:notNull
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "An endpoint must have a ids:Host linked through the ids:endpointHost property."@en
    ] ;

    sh:property [
        a sh:PropertyShape ;
        sh:path ids:path ;
        sh:datatype xsd:string ;
        # idsm:notNull
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "An endpoint must have a relative path at which the content is published by the related host through the ids:path property."@en ;
    ] ;

    sh:property [
        a sh:PropertyShape ;
        sh:path ids:inboundPath ;
        sh:datatype xsd:string ;
        # no idsm validation
        sh:severity sh:Violation ;
        sh:message "An ids:inboundPath must link to a xsd:string."@en ;
    ] ;

    sh:property [
        a sh:PropertyShape ;
        sh:path ids:outboundPath ;
        sh:datatype xsd:string ;
        # no idsm validation
        sh:severity sh:Violation ;
        sh:message "An ids:outboundPath must link to a xsd:string."@en ;
    ] .


<#StaticEndpointShape>
    a sh:NodeShape ;
    sh:targetClass ids:StaticEndpoint ;

    sh:property [
        a sh:PropertyShape ;
        sh:path ids:endpointArtifact ;
        sh:class ids:Artifact ;
        # idsm:notNull + comment 1:1 mapping in property
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:severity sh:Violation ;
        sh:message "An ids:StaticEndpoint must have exactly one ids:Artifact linked through the ids:endpointArtifact property"@en ;
    ] .


<#InteractiveEndpointShape>
    a sh:NodeShape ;
    sh:targetClass ids:InteractiveEndpoint ;

    sh:property [
        a sh:PropertyShape ;
        sh:path ids:endpointOperationBinding ;
        sh:class ids:OperationBinding ;
        # idsm:notNull
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "An ids:InteractiveEndpoint must have at least one ids:OperationBinding linked through the ids:endpointOperationBinding property."@en ;
    ] .